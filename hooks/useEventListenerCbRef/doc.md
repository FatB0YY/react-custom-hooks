# useEventListenerCbRef

Хук `useEventListenerCbRef` предназначен для упрощения привязки слушателя события к DOM-элементу посредством использования `callback ref`.

Вместо того чтобы применять эффект (`useEffect`) для добавления и удаления обработчика, этот хук возвращает `callback ref`, который можно напрямую назначить элементу через его атрибут `ref`.

Когда элемент монтируется, `callback ref` получает его и добавляет к нему обработчик события, а когда элемент размонтируется (или `callback ref` получает значение `null`), происходит автоматическая очистка — обработчик удаляется.

## Разбор работы хука:

1. **Типизация события**

   Хук использует условный тип `GetWindowEvent<Type>`, который проверяет, есть ли переданный тип события (`Type`) в стандартном объекте `WindowEventMap`:

   - Если тип события присутствует в `WindowEventMap` (например, `"click"`, `"keydown"` и т.п.), то обработчик будет типизирован именно под соответствующее событие (например, MouseEvent для `"click"`).
   - Если тип события не найден в `WindowEventMap`, в качестве типа события используется базовый тип `Event`.

2. **Перегрузка функции**

   Реализовано две перегрузки:

   - **Первая перегрузка**: Применяется, когда тип события присутствует в `WindowEventMap`. Это позволяет обеспечить более точную типизацию для стандартных событий браузера.
   - **Вторая (общая) перегрузка**: Применяется для всех остальных случаев, когда тип события задаётся как произвольная строка.

3. **Использование хука useEvent**

   `useEvent` - Возвращает стабильный колбэк, всегда вызывающий последнюю версию переданной функции (всегда актуальную). То есть колбэк теперь всегда будет вызываться по одной ссылке, но иметь всегда актуальную реализацию.

4. **Использование callback ref и механизма очистки**

   - Создаётся `ref cleanupRef` с помощью `useRef`, в который будет сохранена функция очистки (удаления обработчика).
   - Через `useCallback` создаётся функция `cbRef`, которая принимает DOM-элемент в качестве аргумента.
     - Если элемент существует (то есть при монтировании), к нему добавляется обработчик события с помощью `element.addEventListener(type, eventCb)`. Одновременно в `cleanupRef.current` сохраняется функция, которая при вызове удалит этот обработчик.
     - Если элемент равен `null` (то есть при размонтировании), вызывается сохранённая функция очистки (если она существует), а затем `cleanupRef.current` сбрасывается в `null`.

5. **Возвращаемое значение**

   Хук возвращает `callback ref (cbRef)`, который нужно назначить нужному DOM-элементу через атрибут `ref`.
